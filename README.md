# Forecasts SARS-CoV-2

## Installation

Please follow [installation instructions](https://docs.nextstrain.org/en/latest/install.html#installation-steps) for Nextstrain's software tools.

## Usage

> Note: We are using the `nextstrain/base:branch-evofr` image to run `evofr` models since it requires Python3.9, but our base image still supports Python3.7.

To run pipeline for all available data for generated by ingest:

```
nextstrain build --docker --image nextstrain/base:branch-evofr .
```

To run the pipeline for specific data provenance and geo resolution (e.g. gisaid and global only):

```
nextstrain build --docker --image nextstrain/base:branch-evofr . --configfile config/config.yaml --config data_provenances=gisaid geo_resolutions=global
```

Edit the `prepare_data` params in `config/config.yaml` if you want to change any data preparation options.

## Configuration
The `data_provenances` and `geo_resolutions` are required configs for the pipeline.

The current available options for `data_provenances` are
- open
- gisaid

The current available options for `geo_resolutions` are
- global
- usa

### Model configurations
The specific model configurations are housed in separate config YAML files or each model.
These separate config files must be provided in the main config as `mlr_config` and `renewal_config` in order to run the models.
By default, the model config files used are `config/mlr-config.yaml` and `config/renewal-config.yaml`.
Note the inputs and outputs for the models are overridden in the Snakemake pipeline to conform to the Snakemake input/output framework.

### Environment variables

No environment variables are required for open data.
However, the following environment variables are required for the gisaid data:
- `AWS_DEFAULT_REGION`
- `AWS_ACCESS_KEY_ID`
- `AWS_SECRET_ACCESS_KEY`
